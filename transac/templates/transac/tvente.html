{% extends 'transac/layouts/base.html' %} {% load static %} {% block content %}
<div class="margin-bottom-30">
            <div class="row">
              <div class="col-md-12">
                <form id="navsearch" class="navbar-form">
                  {% csrf_token %}
                  <ul class="nav nav-pills">
                    <!--<li class="active"><a href="#">Compte ouvert<span class="badge">42</span></a></li>
                    <li class="active"><a href="#">Non finalisé <span class="badge">26</span></a></li>
                    <li class="active"><a href="#">Abandonné <span class="badge">14</span></a></li> -->
                    <li>
                        <!-- <select class="form-control margin-bottom-15" id="typeArticle">
                          <option value="" selected>Type d'article</option>
                          <option>Immobilier</option>
                          <option>Moto</option>
                          <option>Electroménager</option>
                        </select> -->
                        <select class="form-control margin-bottom-15" name="article_interet" id="articleI">
                          <option>No de dossier</option>
                          <option>Telephone</option>
                          <option>Nom</option>
                        </select>
                      </form>
                    </li> 
                    <li>
                        &nbsp;&nbsp;<input name='dossier_id' class="form-control" id="templatemo_search_box" placeholder="N° de dossier">
                        <span id="rechercher" class="btn btn-default">Rechercher</span>
                    </li> 
                  </ul>    
                </form>      
              </div>
            </div>
          </div>      

          <div class="row">
            <div class="col-md-6">
              <div class="templatemo-alerts">
                <div class="row">
                  <div class="col-md-12">
                    <div id="success" class="alert alert-success alert-dismissible" role="alert">
                      <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Fermer</span></button>
                      <strong>Succès !</strong> Ce dossier a bien été trouvé.
                    </div>
                  
                    <div id="info" class="alert alert-info alert-dismissible" role="alert">
                      <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                      Tout est en ordre vous pouvez consulter.
                    </div>
                  </div>  
                </div>            
              </div>              
            </div>
            <div class="col-md-6">
              <div class="templatemo-alerts">
                <div class="row">
                  <div class="col-md-12">                    
                    <div id="warning" class="alert alert-warning alert-dismissible" role="alert">
                      <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Fermer</span></button>                   
                        Aucun document à afficher. {{ dossier }}
                    </div>
                    <div id="error" class="alert alert-danger alert-dismissible" role="alert">
                      <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                      Nous n'avons pas trouvé de dossier correspondant à ce numéro.
                    </div>            
                  </div>  
                </div>            
              </div>              
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">

            {% if dossier %}

                <div class="table-responsive">
                  <table class="table table-striped table-hover table-bordered">
                    <thead>
                      <tr>
                        <th>N° client</th>
                        <th>Téléphone</th>
                        <th>Nom</th>
                        <th>Prénom</th>
                        <th>N°dossier</th>
                        <th>Statut</th>
                        <th>Dernier Paiement</th>
                        <th>Coeff recouvr</th>
                        <th>Appelé & récouvré</th>
                        <th>Dernier appel</th>
                        
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>{{ dossier.client.uid }}</td>
                        <td>{{ dossier.client.phone_1 }}</td>
                        <td>{{ dossier.client.nom }}</td>
                        <td>{{ dossier.client.prenom }}</td>
                        <td>{{ dossier.uid }}</td>
                        <td>{{ dossier.statut }}</td>
                        <td>{{ dossier.article.date_dernier_paiement }}</td>
                        <td>{{ dossier.coeff_recouv}}</td>
                        <td>{{ dossier.appele_recouvre }}</td>
                        <td>{{ dossier.dernier_appel}}</td>
                        
                      </tr>                                             
                    </tbody>
                  </table>
                </div>     

              <div class="panel-group" id="accordion">
                  <div class="panel panel-default">
                    <div class="panel-heading">
                      <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                          <span class="badge">1</span>&nbsp; Information produit cédé
                        </a>
                      </h4>
                    </div>
                    <div id="collapseOne" class="panel-collapse collapse in">
                      <div class="panel-body">
                        <div class="row">
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvArticle" class="control-label">Article</label>
                            <input type="text" class="form-control" id="tvArticle" value="Terrain nu" disabled>
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvSite" class="control-label">Site</label>
                            <input type="text" class="form-control" id="tvSite" value="Komsilga" />   
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label for="tvDimension" class="control-label">Dimension</label>
                            <input type="text" class="form-control" id="tvDimension" value="350m&sup2;" />
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label for="tvSituation" class="control-label">Situation</label>
                            <input type="text" class="form-control" id="tvSituation" value="" />   
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvTypeDocs" class="control-label">Type DOCS</label>
                            <input type="text" class="form-control" id="tvTypeDocs" value="Attestation villageoise" />
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvNstock" class="control-label">N° de stock</label>
                            <input type="text" class="form-control" id="tvNstock" value="KINT10001" />   
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvNomCite" class="control-label">Nom de la cité</label>
                            <input type="text" class="form-control" id="tvNomCite" value="Cité Emergence 2025" />
                          </div>
                        </div>

                      </div>
                    </div>
                  </div>
                  <div class="panel panel-default">
                    <div class="panel-heading">
                      <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">
                          <span class="badge">2</span>&nbsp; Information vendeur
                        </a>
                      </h4>
                    </div>
                    <div id="collapseTwo" class="panel-collapse collapse">
                      <div class="panel-body">
                        
                        <div class="row">
                          <div class="col-md-8 margin-bottom-15">
                            <label for="tvNomVendeur" class="control-label">Nom</label>
                            <input type="text" class="form-control" id="tvNomVendeur" value={{user.societe.nom}} disabled>
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvTelephone" class="control-label">Téléphone</label>
                            <input type="text" class="form-control" id="tvTelephone" value={{user.societe.telephone}} disabled>   
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-md-6 margin-bottom-15">
                            <label for="tvAdresse" class="control-label">Adresse</label>
                            <input type="text" class="form-control" id="tvAdresse" value={{user.societe.address}} disabled>
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label for="tvCp" class="control-label">Code postal</label>
                            <input type="text" class="form-control" id="tvCp" value={{user.societe.code_postal}} disabled>   
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label for="tvVille" class="control-label">Ville</label>
                            <input type="text" class="form-control" id="tvVille" value={{user.societe.ville}} disabled>
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label for="tvPays" class="control-label">Pays</label>
                            <input type="text" class="form-control" id="tvPays" value={{user.societe.pays}} disabled>   
                          </div>
                        </div>

                      </div>
                    </div>
                  </div>
                  <div class="panel panel-default">
                    <div class="panel-heading">
                      <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree">
                          <span class="badge">3</span>&nbsp; Information institution garante
                        </a>
                      </h4>
                    </div>
                    <div id="collapseThree" class="panel-collapse collapse">
                      <div class="panel-body">
                        <div class="row">
                          <div class="col-md-8 margin-bottom-15">
                            <label for="tvNomIg" class="control-label">Nom</label>
                            <input type="text" class="form-control" id="tvNomIg" value="Wend Puire Distribution" disabled>
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvTelephoneIg" class="control-label">Téléphone</label>
                            <input type="text" class="form-control" id="tvTelephoneIg" value="+226 64 45 89 98" disabled>   
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-md-6 margin-bottom-15">
                            <label for="tvAdresseIg" class="control-label">Adresse</label>
                            <input type="text" class="form-control" id="tvAdresseIg" value="Secteur 54, parcelle 14, lot 33, section 283, Ouaga 2000" disabled>
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label for="tvCpIg" class="control-label">Code postal</label>
                            <input type="text" class="form-control" id="tvCpIg" value="01 BP 5414" disabled>   
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label for="tvVilleIg" class="control-label">Ville</label>
                            <input type="text" class="form-control" id="tvVilleIg" value="Ouagadougou 01" disabled>
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label for="tvAgentIg" class="control-label">Agent</label>
                            <input type="text" class="form-control" id="tvAgentIg" value="" disabled>   
                          </div>
                        </div>

                        <strong>Autre institution garante</strong><br>
                        <div class="row">
                          <div class="col-md-8 margin-bottom-15">
                            <label for="tvNomIgScd" class="control-label">Nom</label>
                            <input type="text" class="form-control" id="tvNomIgScd" value="Bank of Bermudes" disabled>
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvTelephoneIgScd" class="control-label">Téléphone</label>
                            <input type="text" class="form-control" id="tvTelephoneIgScd" value="+226 64 45 89 98" disabled>   
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-md-6 margin-bottom-15">
                            <label for="tvAdresseIgScd" class="control-label">Adresse</label>
                            <input type="text" class="form-control" id="tvAdresseIgScd" value="Secteur 24, parcelle 11, lot 31, section 143, Ouaga 3000" disabled>
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label for="tvCpIgScd" class="control-label">Code postal</label>
                            <input type="text" class="form-control" id="tvCpIgScd" value="01 BP 5414" disabled>   
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label for="tvVilleIgScd" class="control-label">Ville</label>
                            <input type="text" class="form-control" id="tvVilleIgScd" value="Ouagadougou 01" disabled>
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label for="tvAgentIgScd" class="control-label">Agent</label>
                            <input type="text" class="form-control" id="tvAgentIgScd" value="" disabled>   
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="panel panel-default">
                    <div class="panel-heading">
                      <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseFour">
                          <span class="badge">4</span>&nbsp; Information assurance ou protection
                        </a>
                      </h4>
                    </div>
                    <div id="collapseFour" class="panel-collapse collapse">
                      <div class="panel-body">
                        <strong>Vie et invalidité</strong><br>
                        <div class="row">
                          <div class="col-md-6 margin-bottom-15">
                            <label for="tvNomIap" class="control-label">Nom</label>
                            <input type="text" class="form-control" id="tvNomIap" value="Wend Puire Distribution" disabled>
                          </div>
                          <div class="col-md-6 margin-bottom-15">
                            <label for="tvAdresseIap" class="control-label">Adresse</label>
                            <input type="text" class="form-control" id="tvAdresseIap" value="Secteur 24, parcelle 11, lot 31, section 143, Ouaga 3000" disabled>   
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvVilleIap" class="control-label">Ville</label>
                            <input type="text" class="form-control" id="tvVilleIap" value="Ouagadougou" disabled>
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvPaysIap" class="control-label">Pays</label>
                            <input type="text" class="form-control" id="tvPaysIap" value="Burkina Faso" disabled>   
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvTelIap" class="control-label">Téléphone</label>
                            <input type="text" class="form-control" id="tvTelIap" value="+226 64 45 89 98" disabled>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvNumIap" class="control-label">N° police</label>
                            <input type="text" class="form-control" id="tvNumIap" value="" disabled>
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvAgentIap" class="control-label">Agent</label>
                            <input type="text" class="form-control" id="tvAgentIap" value="" disabled>   
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvDateExpIap" class="control-label">Date d'expiration</label><br>
                            <a href='#'>voir contrat</a>
                          </div>
                        </div>

                        <strong>Perte d'emploi ou de revenu</strong><br>
                        <div class="row">
                          <div class="col-md-6 margin-bottom-15">
                            <label for="tvNomIapScd" class="control-label">Nom</label>
                            <input type="text" class="form-control" id="tvNomIapScd" value="Wend Puire Distribution" disabled>
                          </div>
                          <div class="col-md-6 margin-bottom-15">
                            <label for="tvAdresseIapScd" class="control-label">Adresse</label>
                            <input type="text" class="form-control" id="tvAdresseIapScd" value="Secteur 24, parcelle 11, lot 31, section 143, Ouaga 3000" disabled>   
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvVilleIapScd" class="control-label">Ville</label>
                            <input type="text" class="form-control" id="tvVilleIapScd" value="Ouagadougou" disabled>
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvPaysIapScd" class="control-label">Pays</label>
                            <input type="text" class="form-control" id="tvPaysIapScd" value="Burkina Faso" disabled>   
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvTelIapScd" class="control-label">Téléphone</label>
                            <input type="text" class="form-control" id="tvTelIapScd" value="+226 64 45 89 98" disabled>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvNumIapScd" class="control-label">N° police</label>
                            <input type="text" class="form-control" id="tvNumIapScd" value="" disabled>
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvAgentIapScd" class="control-label">Agent</label>
                            <input type="text" class="form-control" id="tvAgentIapScd" value="" disabled>   
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvDateExpIapScd" class="control-label">Date d'expiration</label><br>
                            <a href='#'>voir contrat</a>
                          </div>
                        </div>

                        <strong>SOS Réparation</strong><br>
                        <div class="row">
                          <div class="col-md-6 margin-bottom-15">
                            <label for="tvNomIapThd" class="control-label">Nom</label>
                            <input type="text" class="form-control" id="tvNomIapThd" value="Wend Puire Distribution" disabled>
                          </div>
                          <div class="col-md-6 margin-bottom-15">
                            <label for="tvAdresseIapThd" class="control-label">Adresse</label>
                            <input type="text" class="form-control" id="tvAdresseIapThd" value="Secteur 24, parcelle 11, lot 31, section 143, Ouaga 3000" disabled>   
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvVilleIapThd" class="control-label">Ville</label>
                            <input type="text" class="form-control" id="tvVilleIapThd" value="Ouagadougou" disabled>
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvPaysIapThd" class="control-label">Pays</label>
                            <input type="text" class="form-control" id="tvPaysIapThd" value="Burkina Faso" disabled>   
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvTelIapThd" class="control-label">Téléphone</label>
                            <input type="text" class="form-control" id="tvTelIapThd" value="+226 64 45 89 98" disabled>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvNumIapThd" class="control-label">N° police</label>
                            <input type="text" class="form-control" id="tvNumIapThd" value="" disabled>
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvAgentIapThd" class="control-label">Agent</label>
                            <input type="text" class="form-control" id="tvAgentIapThd" value="" disabled>   
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label for="tvDateExpIapThd" class="control-label">Date d'expiration</label><br>
                            <a href='#'>voir contrat</a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="panel panel-default">
                    <div class="panel-heading">
                      <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseFive">
                          <span class="badge">5</span>&nbsp; Loan Structure R
                        </a>
                      </h4>
                    </div>
                    <div id="collapseFive" class="panel-collapse collapse">
                      <div class="panel-body">
                        <form id="loan_structure">
                          {% csrf_token %}
                          <h2>Structure prêt</h2>
                          <div class="row">
                            <div class="col-md-6 margin-bottom-15">
                              <label for="tvNomIap" class="control-label" style="color:#99ccff;">TYPE D'ARTICLE </label>
                              <input type="text" class="form-control" style="background-color:#99ccff; color:#000;" id="tvNomIap" value={{dossier.article_interet.type_article}} disabled>
                            </div>
                            <div class="col-md-6 margin-bottom-15">
                              <label class="control-label" style="color:#99ccff;">NUMERO DE STOCK</label>
                              <input type="text" id="numero_de_stock" class="form-control" style="background-color:#99ccff; color:#000;" disabled>   
                            </div>
                          </div>

                          <strong style="color:#99ccff;">Information transaction</strong><br>
                          <div class="row">
                            <div class="col-md-4 margin-bottom-15">
                              <label class="control-label">Valeur article</label>
                              <input type="text" class="form-control" value="100%" disabled>
                              <input type="text" id="valeur_article" class="form-control" value={{dossier.article_interet.valeur}} disabled>
                            </div>
                            <div class="col-md-4 margin-bottom-15">
                              <label class="control-label">TAUX</label>
                              <table>
                                <tr>
                                  <td class="col-md-8">
                                    <input type="number" placeholder="Percentage" class="form-control" id="taux" value={{dossier.credit.taux}} >
                                  </td>
                                  <td class="col-md-4">
                                    &nbsp;<i class="fa fa-long-arrow-right"></i> 
                                  </td>
                                </tr>
                              </table>
                            </div>
                            <div class="col-md-4 margin-bottom-15">
                              <input type="text" class="form-control" pattern="[A-Za-z]{3}" name="valeur_millions" value="six millions" disabled>
                              <input type="text" class="form-control" value="cinq cent" disabled>
                              <input type="text" class="form-control" value="zéro milles" disabled>
                              <input type="text" class="form-control" value="zéro francs CFA" disabled>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-md-4 margin-bottom-15">
                              <label class="control-label">Prise en charge</label>
                              <input type="number" id='prise_en_charge' class="form-control" placeholder="0%">
                              <input type="text" id='prise_en_charge_ro' class="form-control" style="background-color:#99ccff; color:#000;" value="0" disabled>
                            </div>
                            <div class="col-md-4 margin-bottom-15">
                              <label class="control-label">DATE</label>
                              <input type="text" class="form-control" id="thedate"  disabled>   
                            </div>                          
                          </div>
                          <div class="row">
                            <div class="col-md-4 margin-bottom-15">
                              <label class="control-label">Prix de l'article financé</label>
                              <input type="text" id="prix_finance" class="form-control" style="background-color:#99ccff; color:#000;"  value={{dossier.article_interet.valeur}} disabled>
                            </div>                       
                          </div>
                          <div class="row">
                            <div class="col-md-2 margin-bottom-15">
                            </div>
                            <div class="col-md-4 margin-bottom-15">
                              <label class="control-label">Valeur reprise</label>
                              <input type="number" class="form-control" value="0">
                              <label class="control-label">Subvention</label>
                              <input type="number" class="form-control" value="0">
                            </div>
                          </div>    
                          <div class="row">
                            <div class="col-md-2 margin-bottom-15">
                            </div>
                            <div class="col-md-4 margin-bottom-15">
                              <label class="control-label">Accompte frais</label>  
                              <table>
                                <tr>
                                  <td class="col-md-8">
                                    <input id="accompte" type="number" class="form-control" value="0" >  
                                  </td>
                                  <td class="col-md-4">
                                    &nbsp;<i class="fa fa-long-arrow-right"></i> 
                                  </td>
                                </tr>
                              </table> 
                            </div>
                            <div class="col-md-4 margin-bottom-15">
                              <input type="text" class="form-control" value="six millions" disabled>
                              <input type="text" class="form-control" value="cinq cent" disabled>
                              <input type="text" class="form-control" value="zéro milles" disabled>
                              <input type="text" class="form-control" value="zéro francs CFA" disabled>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-md-4 margin-bottom-15">
                              <label class="control-label">TVA (incluse)</label>
                              <input type="text" class="form-control" value="0">
                              <label class="control-label">Commission (si applicable)</label>
                              <input type="text" class="form-control" value="0">
                              <label class="control-label">Immatriculation (si applicable)</label>
                              <input type="text" class="form-control" value="0">
                              <label class="control-label">Transfert titre (si applicable)</label>
                              <input type="text" class="form-control" value="0">
                              <label class="control-label">Autres taxes (si applicable)</label>
                              <input type="text" class="form-control" value="0">
                              <label class="control-label">Frais de dossier</label>
                              <input type="text" id="frais_dossier" class="form-control" style="background-color:#99ccff; color:#000;" value="7 500" disabled>
                            </div>  
                          </div>
                          <div class="row">
                            <div class="col-md-4 margin-bottom-15">
                            </div>  
                            <div class="col-md-4 margin-bottom-15">
                              <label class="control-label">DATE FIN</label>
                              <input type="text" id="fin_date" class="form-control" style="background-color:#99ccff; color:#000;" value="0" disabled>
                            </div>  
                          </div>
                          <strong style="color:#99ccff;">FRAIS SECONDAIRES</strong><br>
                          <div class="row">
                            <div class="col-md-4 margin-bottom-15">
                              <label class="control-label">Estimation durée de paiement</label>
                              <input id="payment_length" type="number" class="form-control" value="240">
                              <label class="control-label">Frais de montage de dossier</label>
                              <input type="text" id="frais_montage" class="form-control" style="background-color:#99ccff; color:#000;" value={{dossier.client.frais_dossier}}>
                              <label class="control-label">Livraison (si applicable)</label>
                              <input type="text" id="frais_livraison" class="form-control">
                              <label class="control-label">Protection perte emploi ou revenu</label>
                              <input type="text" class="form-control" id="perte_emploi" style="background-color:#99ccff; color:#000;"disabled>
                            </div>  
                          </div>
                          <div class="row">
                            <div class="col-md-4 margin-bottom-15">    
                              <table>
                                <tr>
                                  <td class="col-md-8">
                                    <label class="control-label">Protection vie ou invalidité</label>
                                    <input type="text" id="vie_ou_invalidite" class="form-control" style="background-color:#99ccff; color:#000;">  
                                  </td>
                                  <td class="col-md-4">
                                    &nbsp;<i class="fa fa-long-arrow-right"></i> 
                                  </td>
                                </tr>
                              </table> 
                            </div>
                            <div class="col-md-4 margin-bottom-15">
                              <input type="text" class="form-control" value="zéro millions" disabled>
                              <input type="text" class="form-control" value="six cent" disabled>
                              <input type="text" class="form-control" value="vingt milles" disabled>
                              <input type="text" class="form-control" value="zéro francs CFA" disabled>
                            </div>

                          </div>
                          <div class="row">
                            <div class="col-md-4 margin-bottom-15">    
                              <label class="control-label">Protection SOS réparation</label>
                              <input type="text" id="sos_reparation" class="form-control" value="0" >
                              <label for="tvAgentIap" class="control-label">Paiement banque pour reprise (S.A)</label>
                              <input type="text" class="form-control" value="0" >
                              <label for="tvAgentIap" class="control-label">Autres frais</label>
                              <input type="text" id="frais_autre" class="form-control" value={{dossier.client.autre_frais}} >
                            </div> 
                          </div> 
                          <div class="row">
                            <div class="col-md-4 margin-bottom-15">    
                              <table>
                                <tr>
                                  <td class="col-md-8">
                                    <label for="tvAgentIap" class="control-label" style="color:#99ccff;">MONTANT A FINANCER</label>
                                    <input type="text" id = "montant_financer" class="form-control" style="background-color:#99ccff; color:#000;"disabled>  
                                  </td>
                                  <td class="col-md-4">
                                    &nbsp;<i class="fa fa-long-arrow-right"></i> 
                                  </td>
                                </tr>
                              </table> 
                            </div>
                            <div class="col-md-4 margin-bottom-15">
                              <input type="text" class="form-control" value="trois millions" disabled>
                              <input type="text" class="form-control" value="quatre cent" disabled>
                              <input type="text" class="form-control" value="quatre vingt milles" disabled>
                              <input type="text" class="form-control" value="zéro francs CFA" disabled>
                            </div>

                          </div>

                          <div class="row">
                            <div class="col-md-4 margin-bottom-15">    
                              <label class="control-label" style="color:#99ccff;">NOMBRE DE MOIS</label>
                              <input id="payment_length_read_only" type="text" class="form-control" style="background-color:#99ccff; color:#000;" disabled>
                            </div>

                          </div>

                          <div class="row">
                            <div class="col-md-4 margin-bottom-15">    
                              <table>
                                <tr>
                                  <td class="col-md-8">
                                    <label class="control-label" style="color:#99ccff;">PAIEMENT MENSUEL</label>
                                    <input type="number" id="paiement_mensuel" name="paiement_mensuel" class="form-control" style="background-color:#99ccff; color:#000;" disabled>  
                                  </td>
                                  <td class="col-md-4">
                                    &nbsp;<i class="fa fa-long-arrow-right"></i> 
                                  </td>
                                </tr>
                              </table> 
                            </div>
                            <div class="col-md-4 margin-bottom-15">
                              <input type="text" class="form-control" value="zéro millions" disabled>
                              <input type="text" class="form-control" value="zéro cent" disabled>
                              <input type="text" class="form-control" value="vingt neuf milles" disabled>
                              <input type="text" class="form-control" value="zéro francs CFA" disabled>
                            </div>

                          </div>

                          <div class="row">
                            <div class="col-md-4 margin-bottom-15">    
                              <table>
                                <tr>
                                  <td class="col-md-8">
                                    <label for="tvAgentIap" class="control-label" style="color:#99ccff;">TOTAL</label>
                                    <input type="text" id="total" class="form-control" style="background-color:#99ccff; color:#000;" name="total" disabled>  
                                  </td>
                                  <td class="col-md-4">
                                    &nbsp;<i class="fa fa-long-arrow-right"></i> 
                                  </td>
                                </tr>
                              </table> 
                            </div>
                            <div class="col-md-4 margin-bottom-15">
                              <input type="text" class="form-control" value="zéro millions" disabled>
                              <input type="text" class="form-control" value="zéro cent" disabled>
                              <input type="text" class="form-control" value="vingt neuf milles" disabled>
                              <input type="text" class="form-control" value="zéro francs CFA" disabled>
                            </div>

                          </div>
                            <br />

                            <button type="button" id="save_loan" data-loading-text="En cours d'ouverture..." class="btn btn-primary">
                              <!-- <a href="../generatepdf/facture"> -->
                                Save Loan Structure 
                              <!-- </a> -->
                            </button>
                      </form>
                      </div>
                    </div>
                  </div>
                  <div class="panel panel-default">
                    <div class="panel-heading">
                      <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseSix">
                          <span class="badge">6</span>&nbsp; Facture IMP
                        </a>
                      </h4>
                    </div>
                    <div id="collapseSix" class="panel-collapse collapse">
                      <div class="panel-body">                       
                        <button type="button" id="loading-example-btn" data-loading-text="En cours d'ouverture..." class="btn btn-primary">
                          <a href="./generatepdf/facture/{{dossier}}/" target="blank">
                            Editer facture <b class="red">PDF</b>
                          </a>
                        </button>
                      </div>
                    </div>
                  </div>
                  <div class="panel panel-default">
                    <div class="panel-heading">
                      <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseSeven">
                          <span class="badge">7</span>&nbsp; Engagement IMP
                        </a>
                      </h4>
                    </div>
                    <div id="collapseSeven" class="panel-collapse collapse">
                      <div class="panel-body">
                        <h2>Lettre d'engagement irrévocable</h2>

                        <div class="row">
                          <div class="col-md-12">
                            <div class="templatemo-progress">
                              <div class="list-group">
                                <a href="#" class="list-group-item">
                                  <p class="list-group-item-text">Je soussigné(e) <b>include info</b> Né(e) le <b>include info</b> à <b>include info</b><br>
                                    titulaire de la pièce d'identité ou du passeport numéro <b>include info</b> domicilié à <b>include info</b><br>
                                    Ville <b>include info</b> Code postal <b>include info</b> Pays <b>include info</b> m'engage de manière irrévocable par la présente, à payer à la société <b>include info</b> la somme de :<br>
                                    <b>include info</b> millions <b>include info</b> cent <b>include info</b> mille Francs CFA <b>include info</b> F CFA,<br>
                                    soit (<b>include info</b>) <b>include info</b> mensualités de :<br>
                                    <b>include info</b> millions <b>include info</b> cent <b>include info</b> mille <b>include info</b> Francs CFA <b>include info</b> F CFA,<br>
                                    et cela de la période du <b>include info</b> jusqu'au <b>include info</b> représentant les engagements libellés dans le contrat ou protocole d'accord nous liant.<br>
                                    Je m'engage par ailleurs à respecter tous les termes du contrat qui me lient à <b>include info</b><br>
                                    et à respecter les paiements en temps et en heure au bureau local, régional, ou à l'(aux) institution(s) désignée(s) par cette dernière.<br>
                                    En foi de quoi je délivre cette présente lettre d'engagement irrévocable pour servir et valoir ce que de droit.
                                  </p>
                                </a>
                                <br>

                                <button type="button" id="loading-example-btn2" data-loading-text="En cours d'ouverture..." class="btn btn-primary">
                                  <a href="./generatepdf/engagement/{{dossier}}/" target="blank"> 
                                      Editer engagement <b class="red">PDF</b>
                                  </a>
                                </button>

                                <br>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="panel panel-default">
                    <div class="panel-heading">
                      <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseEight">
                          <span class="badge">8</span>&nbsp; PPE IMP
                        </a>
                      </h4>
                    </div>
                    <div id="collapseEight" class="panel-collapse collapse">
                      <div class="panel-body">
                        <button type="button" id="loading-example-btn3" data-loading-text="En cours d'ouverture..." class="btn btn-primary">
                          
                          <a href="./generatepdf/ppe_imp/{{dossier}}/" target="blank"> 
                            Editer protection perte d'emploi terrain <b class="red">PDF</b>
                          </a>
                          
                        </button>
                      </div>
                    </div>
                  </div>
                  <div class="panel panel-default">
                    <div class="panel-heading">
                      <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseNine">
                          <span class="badge">9</span>&nbsp; PPR IMP
                        </a>
                      </h4>
                    </div>
                    <div id="collapseNine" class="panel-collapse collapse">
                      <div class="panel-body">
                        <button type="button" id="loading-example-btn4" data-loading-text="En cours d'ouverture..." class="btn btn-primary">
                          <a href="./generatepdf/ppr_imp/{{dossier}}/" target="blank"> 
                          Editer protection perte de revenus terrain <b class="red">PDF</b>
                          </a>
                        </button>
                      </div>
                    </div>
                  </div>
                  <div class="panel panel-default">
                    <div class="panel-heading">
                      <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseTen">
                          <span class="badge">10</span>&nbsp; PVI IMP
                        </a>
                      </h4>
                    </div>
                    <div id="collapseTen" class="panel-collapse collapse">
                      <div class="panel-body">
                        <button type="button" id="loading-example-btn5" data-loading-text="En cours d'ouverture..." class="btn btn-primary">
                          <a href="./generatepdf/pvi_imp/{{dossier}}/" target="blank">
                            Editer protection vie et invalidité terrain <b class="red">PDF</b>
                          </a>
                        </button>
                      </div>
                    </div>
                  </div>
                  <div class="panel panel-default">
                    <div class="panel-heading">
                      <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseEleven">
                          <span class="badge">11</span>&nbsp; Contrat terrain IMP
                        </a>
                      </h4>
                    </div>
                    <div id="collapseEleven" class="panel-collapse collapse">
                      <div class="panel-body">
                        <button type="button" id="loading-example-btn6" data-loading-text="En cours d'ouverture..." class="btn btn-primary">
                          
                          <a href="./generatepdf/ct_imp/{{dossier}}/" target="blank">
                             Editer contrat de location - cession de terrain à usage d'habitation <b class="red">PDF</b>
                          </a>
                        </button>
                      </div>
                    </div>
                  </div>
                  <div class="panel panel-default">
                    <div class="panel-heading">
                      <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwelve">
                          <span class="badge">12</span>&nbsp; BAL IMP
                        </a>
                      </h4>
                    </div>
                    <div id="collapseTwelve" class="panel-collapse collapse">
                      <div class="panel-body">
                        <strong style="color:#99ccff;">Information gérant</strong><br>
                        <div class="row">
                          <div class="col-md-8 margin-bottom-15">
                            <label class="control-label">Nom</label>
                            <input type="text" class="form-control" value="Albert Sangaré" disabled>
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label class="control-label">Téléphone</label>
                            <input type="text" class="form-control" value="+226 64 45 89 98" disabled>   
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-md-6 margin-bottom-15">
                            <label class="control-label">Adresse</label>
                            <input type="text" class="form-control" value="Secteur 54, parcelle 14, lot 33, section 283, Ouaga 2000" disabled>
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label class="control-label">Code postal</label>
                            <input type="text" class="form-control" value="01 BP 5414" disabled>   
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label class="control-label">Ville</label>
                            <input type="text" class="form-control" value="Ouagadougou 01" disabled>
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label class="control-label">Agent</label>
                            <input type="text" class="form-control" value="" disabled>   
                          </div>
                        </div>

                        <strong style="color:#99ccff;">Information concessionnaire</strong><br>
                        <div class="row">
                          <div class="col-md-8 margin-bottom-15">
                            <label class="control-label">Nom</label>
                            <input type="text" class="form-control" value="Motorsport Ouaga" disabled>
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label class="control-label">Téléphone</label>
                            <input type="text" class="form-control" value="+226 64 45 89 98" disabled>   
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-md-6 margin-bottom-15">
                            <label class="control-label">Adresse</label>
                            <input type="text" class="form-control" value="Secteur 24, parcelle 11, lot 31, section 143, Ouaga 3000" disabled>
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label class="control-label">Code postal</label>
                            <input type="text" class="form-control" value="01 BP 5414" disabled>   
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label class="control-label">Ville</label>
                            <input type="text" class="form-control" value="Ouagadougou 01" disabled>
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label class="control-label">Pays</label>
                            <input type="text" class="form-control" value="Burkina Faso" disabled>   
                          </div>
                        </div>

                        <strong style="color:#99ccff;">Information article à livrer</strong><br>
                        <div class="row">
                          <div class="col-md-3 margin-bottom-15">
                            <label class="control-label">Article</label>
                            <input type="text" class="form-control" value="Moto" disabled>
                          </div>
                          <div class="col-md-3 margin-bottom-15">
                            <label class="control-label">Marque</label>
                            <input type="text" class="form-control" value="Yamaha" disabled>   
                          </div>
                          <div class="col-md-3 margin-bottom-15">
                            <label class="control-label">Modèle</label>
                            <input type="text" class="form-control" value="SIRIUS" disabled>
                          </div>
                          <div class="col-md-3 margin-bottom-15">
                            <label class="control-label">Code</label>
                            <input type="text" class="form-control" value="YMHSS" disabled>   
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-md-3 margin-bottom-15">
                            <label class="control-label">Couleur</label>
                            <input type="text" class="form-control" value="Blanche" disabled>
                          </div>
                          <div class="col-md-3 margin-bottom-15">
                            <label class="control-label">N° de stock</label>
                            <input type="text" class="form-control" value="0" disabled>
                          </div>
                          <div class="col-md-3 margin-bottom-15">
                            <label class="control-label">N° de série</label>
                            <input type="text" class="form-control" value="0" disabled>   
                          </div>
                        </div>

                        <strong style="color:#99ccff;">Information client</strong><br>
                        <div class="row">
                          <div class="col-md-4 margin-bottom-15">
                            <label class="control-label">Nom</label>
                            <input type="text" class="form-control" value="Mahmoud SERI" disabled>
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label class="control-label">Téléphone</label>
                            <input type="text" class="form-control" value="+226 64 45 89 98" disabled>   
                          </div>
                          <div class="col-md-4 margin-bottom-15">
                            <label class="control-label">CNI</label>
                            <input type="text" class="form-control" value="" disabled>   
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-md-6 margin-bottom-15">
                            <label class="control-label">Adresse</label>
                            <input type="text" class="form-control" value="Secteur 24, parcelle 11, lot 31, section 143, Ouaga 3000" disabled>
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label class="control-label">Code postal</label>
                            <input type="text" class="form-control" value="01 BP 5414" disabled>   
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label class="control-label">Ville</label>
                            <input type="text" class="form-control" value="Ouagadougou 01" disabled>
                          </div>
                          <div class="col-md-2 margin-bottom-15">
                            <label class="control-label">Pays</label>
                            <input type="text" class="form-control" value="" disabled>   
                          </div>
                        </div>

                        <button type="button" id="loading-example-btn7" data-loading-text="En cours d'ouverture..." class="btn btn-primary">
                          <a href="./generatepdf/bal_imp/{{dossier}}/" target="blank">
                             Editer Bon à livre <b class="red">PDF</b>
                          </a>
                         
                        </button>
                      
                      </div>
                    </div>
                  </div>                  
              </div>
            
            {% endif %}

            </div>
              
          </div>  
          
          </div> 
{% endblock %} {% block modal %}
<!-- Modal -->
<div
  class="modal fade"
  id="confirmOpen"
  tabindex="-1"
  role="dialog"
  aria-labelledby="myModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">
          <span aria-hidden="true">&times;</span
          ><span class="sr-only">Fermer</span>
        </button>
        <h4 class="modal-title" id="myModalLabel">
          Voulez vous vraiment ouvrir ce dossier
        </h4>
      </div>
      <div class="modal-footer">
        <a href="../logout" class="btn btn-primary">Oui</a>
        <button type="button" class="btn btn-default" data-dismiss="modal">
          Non
        </button>
      </div>
    </div>
  </div>
</div>
<div
  class="modal fade"
  id="confirmModal"
  tabindex="-1"
  role="dialog"
  aria-labelledby="myModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">
          <span aria-hidden="true">&times;</span
          ><span class="sr-only">Fermer</span>
        </button>
        <h4 class="modal-title" id="myModalLabel">
          Voulez vous vraiment vous déconnecter ?
        </h4>
      </div>
      <div class="modal-footer">
        <a href="../logout" class="btn btn-primary">Oui</a>
        <button type="button" class="btn btn-default" data-dismiss="modal">
          Non
        </button>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<script type="text/javascript">
    console.log("{{client}}")
    var success_messages        = document.getElementById('success')
    var warning_messages        = document.getElementById('warning')
    var info_messages           = document.getElementById('info')
    var error_messages          = document.getElementById('error')

    success_messages.style.display = 'none'
    error_messages.style.display   = 'none'
    info_messages.style.display    = 'none'

  $('#myTab a').click(function (e) {
    e.preventDefault();
    $(this).tab('show');
  });

  $('#loading-example-btn').click(function () {
    var btn = $(this);
    btn.button('loading');
    // $.ajax(...).always(function () {
    //   btn.button('reset');
    // });
  });

  // Search for a specific document
  
  // $('#rechercher').click(function(e)
  document.getElementById("rechercher").onclick = function(e){
    console.log(e)
    e.preventDefault()
    let debitor_form = document.getElementById('navsearch')

    var fd = new FormData(debitor_form);
    console.log(fd)

    $.ajax({
                type: "POST",
                url: `/transac/vente`,
                data: fd,
                processData: false,
                contentType: false,
                success: function(data,status) {
                  warning_messages.style.display = 'none'
                  info_messages.style.display    = 'block'
                  let message = document.createElement('div')
                  //this will execute when form is submited without errors
                  location.reload();

              },
              error: function(data, status) {
                  //this will execute when get any error
              },
          });
 
  }
  // )

  $(document).ready(function() {
    var date = new Date();

    var day = date.getDate();
    var month = date.getMonth() + 1;
    var year = date.getFullYear();

    if (month < 10) month = "0" + month;
    if (day < 10) day = "0" + day;

    var today = day + "-" + month + "-" + year;  
    console.log('---------  here  ----------')
    console.log(today) 
    $("#thedate").attr("value", today);
    
});
// make the number digits a multiple 3
function makeNumberMultiple(number){
    // console.log(number)
    let digits = `${number}`.split('').length
    // console.log('<< Multiple is running >>')


    if(digits%3){
        // console.log('its not a multiple, fix it')
        return makeNumberMultiple(`0${number}`)
    }
    else{
        // console.log(' its a multiple, fixed!')
        return number;
    }

}
// name each block and attach its unit
function blockName(number){
    // console.log('<< Hello from the Namer >>')
    let name = ''
    number = `${number}`.split('')
    const N_Constants = {
  
        1:'one',
        01:'one',
        2:'two',
        3:'three',
        4:'four',
        5:'five',
        6:'six',
        7:'seven',
        8:'eight',
        9:'nine',
        10:'ten',
        11:'eleven',
        12:'twelve',
        13:'thirteen',
        14:'fourteen',
        15:'fifteen',
        16:'sixteen',
        17:'seventeen',
        18:'eighteen',
        19:'nineteen',
        20:'twenty',
        30:'thirty',
        40:'fourty',
        50:'fifty',
        60:'sixty',
        70:'seventy',
        80:'eighty',
        90:'ninety'

    }
    
    if(number[0] !='0')
        name = N_Constants[number.shift()]+ " hundred and "
    else{
         number.shift()
        //  console.log('zero found and removed')
    }
       
    if(Object.keys(N_Constants).includes(number.join(''))){
        name = name + N_Constants[`${number.join('')}`]
    }else{

        if(number[0] !='0')
        name = name +  N_Constants[`${number.shift()}0`]+ " "
        else{
            number.shift()
            // console.log('zero found and removed')
        }

        if(number[0] !='0')
            name = name +  N_Constants[number.shift()]+ " "
        else{
            number.shift()
            // console.log('zero found and removed')
        }
       
    }

    return name;

}

function convertNumberToString(number){
    // console.log('<< Hola from the function >>')

    const units = {
        1: '',
        2:' Thousand ',
        3:' Million ',
        4:' Billion ',
        5:" Trillion ",
        6:' Quatrillion ',

    }
    /*Make numbers digits a multiple of 3 */
    number =  makeNumberMultiple(number)
   
    let digits = `${number}`.split('').length;
    let number_of_blocks = digits/3;
    let block_name = ""
    /* name each block and attach its unit */
    number = `${number}`.split('')

    for(let block = 0; block < number_of_blocks; block++){
        // console.log('<< hellloo >>')
        
         /* Split the new number into blocks of 3s */
        let block_number = number.splice(0,3)

        // name each block and attach its unit
        // join every block name from first to last
        if(block_number.join('') != 0)
        block_name = block_name +   blockName(block_number.join('')) + units[`${number_of_blocks - block}`] + " "
        
    }

    // console.log(block_name)
    return block_name

}


Date.prototype.addDays = function(days) {
    var date = new Date(this.valueOf());
    date.setDate(date.getDate() + days);
    return date;
}

var date = new Date();
var days             = Math.ceil((240/12)*365.366666)

var day = date.getDate();
var month = date.getMonth() + 1;
var year = date.getFullYear();

  if (month < 10) month = "0" + month;
  if (day < 10) day = "0" + day;

    var today = day + "-" + month + "-" + year;   
    
  date = date.addDays(days);
  day = date.getDate();
  month = date.getMonth() + 1;
  year = date.getFullYear();

  if (month < 10) month = "0" + month;
  if (day < 10) day = "0" + day;
    
  var fin_date = year +"-" + month + "-" + day ;  


  let payment_duration = document.getElementById('payment_length')
  var valeur_article   = "{{dossier.article_interet.valeur}}"
  var valeur_article_s = convertNumberToString(parseInt(valeur_article))
  var frais_dossier    = "{{dossier.article_interet.frais_dossier}}"
  var numero_stock     = "{{dossier.article_interet.num_stock}}"
  var frais_montage    = "{{dossier.article_interet.frais_montage}}"
  var frais_livraison  = "{{dossier.article_interet.frais_livraison}}"
  var frais_autre      = "{{dossier.article_interet.frais_livraison}}"
  var prise_en_charge  = 0
  var accompte         = 0
  var perte_emploi     = undefined
  var vie_ou_invalidite= perte_emploi
  var prix_de_article  = valeur_article
  var valeur_reprise   = 0
  var subvention       = 0
  var tva              = 0
  var commission       = 0
  var immatriculation  = 0
  var transfer_titre   = 0
  var paiement_banque  = 0
  var autre_tax        = 0
  var sos_reparation   = 0
  var montant_financer = undefined
  var montant_financer = null
  var paiement_mensuel = undefined
  var total            = null
  var taux             = 0
  perte_emploi         = 240 * 2500;
  vie_ou_invalidite    = perte_emploi
  montant_financer     =  parseInt(valeur_article) - 
                          parseInt(valeur_reprise) -
                          parseInt(subvention) + 
                          parseFloat(accompte) + 
                          parseInt(tva) + 
                          parseInt(commission) + 
                          parseInt(immatriculation) + 
                          parseInt(transfer_titre) + 
                          parseInt(frais_autre) + 
                          parseInt(frais_dossier) + 
                          parseInt(frais_montage) + 
                          parseInt(frais_livraison) + 
                          parseInt(perte_emploi) + 
                          parseInt(vie_ou_invalidite) + 
                          parseInt(sos_reparation) + 
                          parseInt(paiement_banque) +
                          parseInt((prise_en_charge * valeur_article))

  montant_financer     =  montant_financer + (taux * montant_financer)

  paiement_mensuel     = montant_financer/240
  total                = parseInt(valeur_article) +
                         parseInt(tva) + 
                         parseInt(commission) +
                         parseInt(immatriculation) + 
                         parseInt(transfer_titre) + 
                         parseInt(frais_autre) + 
                         parseInt(frais_dossier) + 
                         parseInt(frais_montage) + 
                         parseInt(frais_livraison) + 
                         parseInt(perte_emploi) + 
                         parseInt(vie_ou_invalidite) + 
                         parseInt(sos_reparation) + 
                         parseInt(paiement_banque)
                         
  document.getElementById('payment_length_read_only').value   = 240
  document.getElementById('valeur_article').value             = parseInt(valeur_article)
  document.getElementById('prise_en_charge').value            = 0
  document.getElementById('prix_finance').value               = parseInt(valeur_article)
  document.getElementById('frais_dossier').value              = parseInt(frais_dossier)
  document.getElementById('numero_de_stock').value            = numero_stock
  document.getElementById('frais_montage').value              = parseInt(frais_montage)
  document.getElementById('frais_livraison').value            = parseInt(frais_livraison)
  document.getElementById('frais_autre').value                = parseInt(frais_autre)
  document.getElementById('accompte').value                   = parseInt(accompte)
  document.getElementById('sos_reparation').value             = sos_reparation;
  document.getElementById('perte_emploi').value               = perte_emploi
  document.getElementById('vie_ou_invalidite').value          = vie_ou_invalidite
  document.getElementById('montant_financer').value           = montant_financer
  document.getElementById('paiement_mensuel').value           = Math.ceil(paiement_mensuel)
  document.getElementById('total').value                      = total
  document.getElementById('fin_date').value                   = fin_date


$('#payment_length').change(function(e){
  console.log(e.target.value)
  $('#payment_length_read_only').val(e.target.value)
  $('#perte_emploi').val(parseInt(e.target.value)*2500)  
  $('#vie_ou_invalidite').val(parseInt(e.target.value)*2500)
  paiement_mensuel = montant_financer/parseInt(e.target.value)
  $('#paiement_mensuel').val(Math.ceil(paiement_mensuel))
  days  = Math.ceil((parseInt(e.target.value)/12)*365.366666)
  date = new Date()
  date = date.addDays(days);
  day = date.getDate();
  month = date.getMonth() + 1;
  year = date.getFullYear();
  if (month < 10) month = "0" + month;
  if (day < 10) day = "0" + day; 
  fin_date =  year +"-" + month + "-"+ day;  
   document.getElementById('fin_date').value  =  fin_date

})

$('#taux').change(function(e){
  var taux_amount = (parseFloat(e.target.value)/100)*montant_financer
  montant_financer = montant_financer + taux_amount
  paiement_mensuel = montant_financer/parseInt(payment_duration.value)
  paiement_mensuel = Math.ceil(paiement_mensuel)
  // alert(paiement_mensuel)
})

$('#accompte').change(function(e){
  montant_financer     =  parseInt(valeur_article) - 
                          parseInt(valeur_reprise) -
                          parseInt(subvention) + 
                          parseInt(e.target.value) + 
                          parseInt(tva) + 
                          parseInt(commission) + 
                          parseInt(immatriculation) + 
                          parseInt(transfer_titre) + 
                          parseInt(frais_autre) + 
                          parseInt(frais_dossier) + 
                          parseInt(frais_montage) + 
                          parseInt(frais_livraison) + 
                          parseInt(perte_emploi) + 
                          parseInt(vie_ou_invalidite) + 
                          parseInt(sos_reparation) + 
                          parseInt(paiement_banque)
  montant_financer     =  montant_financer + (taux * montant_financer)
  paiement_mensuel     =  montant_financer/240
})

$('#prise_en_charge').change(function(e){
  console.log(montant_financer)
  montant_financer     =  parseInt(valeur_article) - 
                          parseInt(valeur_reprise) -
                          parseInt(subvention) + 
                          parseInt(accompte) + 
                          parseInt(tva) + 
                          parseInt(commission) + 
                          parseInt(immatriculation) + 
                          parseInt(transfer_titre) + 
                          parseInt(frais_autre) + 
                          parseInt(frais_dossier) + 
                          parseInt(frais_montage) + 
                          parseInt(frais_livraison) + 
                          parseInt(perte_emploi) + 
                          parseInt(vie_ou_invalidite) + 
                          parseInt(sos_reparation) + 
                          parseInt(paiement_banque) +
                          parseInt(valeur_article*(e.target.value/100))
                          console.log(montant_financer)
montant_financer     =  montant_financer + (taux * montant_financer)
paiement_mensuel     =  montant_financer/240

document.getElementById('prise_en_charge_ro').value = valeur_article*(e.target.value/100)
document.getElementById('paiement_mensuel').value   = Math.ceil(paiement_mensuel)
document.getElementById('total').value              = montant_financer
$('#montant_financer').val(montant_financer)
$('#paiement_mensuel').val(Math.ceil(paiement_mensuel))

})


$('#save_loan').click(function(e){
  let loan_structure = document.getElementById('loan_structure')
  console.log(loan_structure)

  var fd = new FormData(loan_structure);
  
  somewariable          = document.getElementById('valeur_article').value 
  prise_en_charge       = document.getElementById('prise_en_charge').value 
  prix_finance          = document.getElementById('prix_finance').value 
  frais_dossier         = document.getElementById('frais_dossier').value 
  numbero_de_stock      = document.getElementById('numero_de_stock').value 
  frais_montage         = document.getElementById('frais_montage').value 
  frais_livraison       = document.getElementById('frais_livraison').value 
  frais_autre           = document.getElementById('frais_autre').value 
  accompte              = document.getElementById('accompte').value 
  sos_reparation        = document.getElementById('sos_reparation').value 
  perte_emploi          = document.getElementById('perte_emploi').value 
  vie_ou_invalidite     = document.getElementById('vie_ou_invalidite').value 
  montant_financer     = document.getElementById('montant_financer').value 
  paiement_mensuel      = document.getElementById('paiement_mensuel').value 
  total                 = document.getElementById('total').value 


  fd.append('payment_duration', `${payment_duration.value}` );
  fd.append('valeur_article', `${valeur_article}` );
  fd.append('frais_dossier', `${frais_dossier}` );
  fd.append('frais_montage',`${frais_montage}`)
  fd.append('frais_livraison',`${frais_livraison}`)
  fd.append('frais_autre',`${frais_autre}`)
  fd.append('accompte',`${accompte}`)
  fd.append('sos_reparation',`${sos_reparation}`)
  fd.append('taux',`${taux}`)
  fd.append('total',`${total}`)
  fd.append('paiement_mensuel',`${paiement_mensuel}`)
  fd.append('montant_financier',`${montant_financer}`)
  fd.append('prise_en_charge',`${prise_en_charge}`)
  fd.append('prix_finance',`${prix_finance}`)
  fd.append('date_emission',`${today}`)
  fd.append('date_fin',`${fin_date}`)
  // fd.append('date_fin',`${}`)
  // fd.append('',`${}`)
  // fd.append('',`${}`)
  // fd.append('',`${}`)
  // console.log(fd)
  let current_path = window.location.href
  let path_contents = current_path.split('/')
  let url = null
  if (path_contents.includes('mutation'))
      url = `/transac/vente/mutation/{{dossier}}/{{dossier.article_interet.pk}}/`
  else if(path_contents.includes('restructure'))
      url = `/transac/vente/restructure/{{dossier}}/{{dossier.article_interet.pk}}/`
  else 
      url = `/transac/credit/{{dossier}}/`

  console.log('********** Links to Visit ************')
  console.log(url)
  console.log('********** Links to Visit ************')

  $.ajax({
          type: "POST",
          url: url,
          data: fd,
          processData: false,
          contentType: false,
          success: function(data,status) {
            let message = document.createElement('div')
            //this will execute when form is submited without errors
            window.scrollTo({top:0, behaviour: 'smooth'})
            location.reload();


        },
        error: function(data, status) {
            //this will execute when get any error
        },
    });
})

</script>
{% endblock %}
